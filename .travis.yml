language: python

os:
  - linux

python:
  - 3.6

services: docker

cache: pip

before_cache:
  - rm -f $HOME/.cache/pip/log/debug.log

before_install:
  - docker build -t reflexer/auction-keeper .
script:
  - docker images reflexer/auction-keeper

install:
  - pip install virtualenv --upgrade
  - pip install -r requirements.txt
  - pip install -r requirements-dev.txt

script:
  - "./test.sh"

after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    docker push reflexer/auction-keeper
    fi
  - codecov

notifications:
  email: false
